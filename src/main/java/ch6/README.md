## 6장(객체 지도)

- 길을 직접 알려주는 방법은 기능적이고 해결 방법 지향적인 접근법이라면, 지도를 이용하는 방법은 구조적이고 문제 지향적인 접근법이다. 전자는 재사용 불가능하지만, 후자는 범용적이며 구조적으로 전자보다 더 안정적이다.

- 자주 변경되는 기능이 아니라 안정적인 구조를 따라 역할, 책임, 협력을 구성하는 것이 중점

### 기능 설계대 구조 설계

- 일차원적인 관점에서 소프트웨어를 개발하는 이유는 사용자에게 훌륭한 기능을 제공하기 위해서이다. 훌륭한 기능은 훌륭한 소프트웨어를 만들기 위한 충분조건이지만, 훌륭한 구조는 훌륭한 소프트웨어를 만들기 위한 필요조건이다. 왜냐하면 요구사항이 변경되면, 변경을 수용할 수 있는 선택의 여지를 설계에 마련해놔야 하기 때문이다.

- 지도 은유를 통해 변경에 대비하고 변경의 여지를 남겨 놓는 좋은 방법은 자주 변경되는 기능이 아닌 안정적인 구조를 중심으로 설계하는 것이다. 기능 분해의 경우는 구조가 기능을 따르기 때문에, 하나의 시스템 기능은 더 작은 기능으로 분해되고 하나의 덩어리로 구성되기에 기능이 변경될 경우 소프트웨어가 요동칠 수 있다.

- 반면, 객체지향 접근방법은 안정적인 객체 구조를 바탕으로 시스템 기능을 객체간 책임으로 분배하기에, 기능이 객체의 구조를 따르게 만든다. 기능 분해와 달리 기능이 변경되더라도 객체의 구조는 그대로 유지될 수 있다.

- 객체지도는 사용자의 요구사항이 변경되더라도, 변경되는 기능을 수용할 수 있는 자리를 제공해줄 수 있다. 그래서 안정적이고 재사용 가능하면서도 범용적이다.

### 두 가지 재료 : 기능과 구조

객체지향의 세계를 구축하기 위해 필요한 요소 2가지

- 기능 : 사용자의 목표를 만족시키기 위해 책임을 수행하는 시스템의 행위
- 구조 : 사용자나 이해관계자들이 도메인에 관해 생각하는 개념과 개념들간의 관계로 표현
- 기능을 수집하고 표현하기 위한 기법 - 유스케이스 모델링, 구조를 수집하고 표현하기 위한 기법 - 도메인 모델링

안정적인 재료 : 구조

### 도메인 모델

- 도메인이란 사용자가 프로그램을 사용하는 대상 분야이다.
- 도메인 모델이란 사용자가 프로그램을 사용하는 대상 영역에 관한 지식을 선택적으로 단순화하고 의식적으로 구조화한 형태이다. 또한, 단순히 다이어그램이 아닌 이해관계자들이 바라보는 멘탈 모델(Mental Model)이다.
- 멘탈 모델이란 사람들이 자기 자신, 다른 사람, 환경, 자신이 상호작용하는 사물들에 대해 갖는 모형이다. 사람들은 세상에 존재하는 현상을 이해하고 현상에 반응하기 위해 자신의 마음 속에 멘탈 모델을 구축한다.
- 멘탈 모델은 사용자 모델, 디자인 모델, 시스템 이미지의 세 가지로 구분
- 사용자 모델은 사용자가 제품에 대해 가지고 있는 개념들의 모습이고, 디자인 모델은 설계자가 마음 속에 갖고 있는 시스템에 대한 개념화고, 시스템 이미지는 최종 제품이다.
- 사용자의 모델과 디자인 모델이 동일하면 이상적이지만, 사용자와 설계자는 서로 상호작용할 수 없으며, 시스템을 통해서만 의사소통 할 수 있다.

### 도메인의 모습을 담을 수 있는 객체지향

- 최종 제품은 사용자의 관점을 반영해야 한다. 즉, 사용자가 도메인을 바라보는 관점을 반영해야 한다. 애플리케이션이 도메인 모델을 기반으로 설계돼야 한다는 것이다.
- 도메인 모델이란 사용자들이 도메인을 바라보는 관점이며, 설계자가 시스템의 구조를 바라보는 관점인 동시에 소프트웨어 안에 구현된 코드의 모습이다.
- 객체지향을 사용하면, 사용자들이 이해하고 있는 도메인의 구조와 최대한 유사하게 코드를 구조화할 수 있다.
- 도메인에 대한 사용자 모델, 디자인 모델, 시스템 이미지가 유사한 모습을 유지하도록 만드는 것이 가능해진다.

### 객체지향의 특징 (연결완정성, 표현적 차이)

- 소프트웨어 객체는 현실 객체에 대한 추상화가 아니다. 현실 객체를 모방한 것이 아니라, 은유를 기반으로 재창조한 것이다.
- 표현적 차이란 소프트웨어 객체와 현실 객체 사이의 의미적 거리인데, 이를 은유를 통해 최대한 줄이는 것이 객체지향의 목표이다.
- 표현적 차이가 중요한 이유는 소프트웨어를 이해하고 수정하기 쉽게 만들어주기 때문이다. 코드의 전반적인 구조는 도메인의 구조를 따르기 때문에, 코드를 이해하기가 훨씬 수월해진다.

### 불안정한 기능을 담는 안정적인 모델

- 도메인 모델을 기반으로 코드를 작성하는 이유는 도메인 모델이 제공하는 구조가 상대적으로 안정적이기 때문이다.
- 도메인 모델의 핵심은 사용자가 도메인을 바라보는 관점을 반영해 소프트웨어를 설계하는 것이다.
- 이는 사용자의 “본질적인” 측면을 가장 잘 이해하고 있다는 뜻이다.
- 본질적이라는 것은 변경이 적고, 특성이 오랜 시간 지속된다는 것을 의미한다. 변경되더라도 변경에 대해 쉽게 대처할 수 있게 된다.

### 정기예금 도메인 모델

- 정기예금 : 예금주가 일정 기간 환급을 요구하지 않을 것을 약정하고 일정 금액을 은행에 예치하는 예금 방식이다.
- 은행 도메인 관점에서 정기예금은 약정 기간이 지난 후 이자를 지급하고 해지하는 금융상품의 일종이다. 예금주가 정기예금을 신청하면 은행은 예금주가 일정 금액을 예치할 수 있게 신규 계좌를 개설한다. 만기시, 특정 이자율에 따라 이자를 지급
- 정기예금 도메인 : 기간, 해지여부, 계좌 도메인 : 계좌번호, 예금액, 이자 : 금액, 지급일자, 이자율 : 금리

### 불안정한 재료 : 기능

- 기능적 요구사항이란 시스템이 사용자에게 제공해야 하는 기능의 목록을 정리한 것
- 사용자들이 시스템을 통해 달성하고자 하는 목표가 있기 때문에 시스템이 사용자에게 기능을 제공한다.
- 사용자는 시스템의 응답을 기반으로 또 다른 작업을 요청하고, 시스템은 요청을 처리한 후 사용자에게 응답한다. 즉, 목표를 달성하기 위해 사용자와 시스템간의 상호작용을 “유스케이스”라고 부른다.

### 유스케이스의 특성

- 첫째, 유스케이스는 사용자와 시스템 간의 상호작용을 보여주는 시스템이다.
- 둘째, 유스케이스는 하나의 시나리오가 아니라 여러 시나리오들의 집합이다.
- 셋째, 유스케이스는 단순히 피처(feature) 목록과 다르다. 피처는 시스템이 수행해야 하는 기능의 목록을 나열한 것이고, 유스케이스는 단순히 기능을 나열하는 것이 아니라 이야기를 통해 연관된 기능들을 묶을 수 있다.
- 넷째, 유스케이스는 사용자 인터페이스와 관련된 세부 정보를 포함하지 말아야 한다.
- 다섯째, 유스케이스는 내부 설계와 관련된 정보를 포함하지 않는다.

유스케이스는 설계 기법도, 객체지향 기법도 아니다.

- 유스케이스는 사용자가 바라보는 시스템의 외부 관점만을 표현한다.
- 시스템의 내부 구조나 실행 메커니즘에 관한 어떠한 정보도 제공하지 않는다.

### 재료 합치기 : 기능과 구조의 조합

- 훌륭한 객체지향 설계자가 갖춰야 할 기본적인 설계 능력은 불안정한 기능을 안정적인 구조 안에 담음으로써 변경에 대한 파급효과를 최소화시키는 것.
- 유스케이스는 사용자에게 제공할 기능을 시스템의 책임으로 보게 함으로써 객체 간의 안정적인 구조에 책임을 분배할 수 있는 출발점을 제공한다.
- 책임-주도 설계는 유스케이스로부터 첫 번째 메세지와 사용자가 달성하려는 목표를, 도메인 모델로부터 기능을 수용할 수 있는 안정적인 구조를 제공받아 실제로 동작하는 객체들의 협력 공동체를 창조한다.
- 책임-주도 설계 방법은 시스템의 기능을 역할과 책임을 수행하는 객체들의 협력 관계로 바라보게 함으로써 두 가지 기본 재료인 유스케이스와 도메인 모델을 통합한다.

기능 변경을 흡수하는 안정적인 구조

### 도메인 모델을 기반으로 객체 구조를 설계하는 이유는 도메인 모델이 안정적이기 때문이다.

- 도메인 모델을 구성하는 개념은 비즈니스가 없어지거나 완전히 개편되지 않는 한 안정적으로 유지된다. 정기예금 도메인에서 계좌, 이자율, 이자란 개념은 정기예금이란 금융상품이 없어지지 않은 한 안정적으로 유지되는 개념이다.

### 도메인 모델의 특징

- 도메인 모델을 중심으로 객체 구조를 설계하고 유스케이스의 기능을 객체의 책임으로 분배하는 기본적인 객체지향 설계 방식의 유연함을 잘 보여준다. 비즈니스 정책이나 규칙이 크게 변경되지 않는 한 시스템의 기능이 변경되더라도 객체간의 관계는 일정하게 유지된다.
- 기능적인 요구사항이 변경될 경우 책임과 객체 간의 대응 관계만 수정될 뿐이다.
- 이것은 변경에 대한 파급효과를 최소화하고 요구사항 변경에 유연하게 대응할 수 있는 시스템을 구축할 수 있게 된다.